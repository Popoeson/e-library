<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>E-Library â€” Login</title>

<style>
  :root {
    --bg: #f4f6fa;
    --card: #fff;
    --muted: #6b7280;
    --accent: #2563eb;
    --shadow: rgba(0,0,0,0.08);
    --radius: 14px;
    --container-width: 400px;
  }

  * { box-sizing: border-box; }
  body, html { margin:0; padding:0; font-family: Inter, sans-serif; background: var(--bg); display:flex; justify-content:center; align-items:center; height:100vh; }

  .container { 
    background: var(--card); 
    width:100%; 
    max-width: var(--container-width); 
    padding:32px; 
    border-radius:var(--radius); 
    box-shadow:0 12px 32px var(--shadow); 
    text-align:center; 
  }

  .logo { font-size:28px; font-weight:700; margin-bottom:8px; display:block; }
  .tagline { font-size:14px; color: var(--muted); margin-bottom:24px; }

  .oauth-btn { display:flex; align-items:center; justify-content:center; gap:8px; padding:16px; margin:12px 0; border-radius: var(--radius); cursor:pointer; border:1px solid #d1d5db; transition: all 0.2s ease; font-weight:600; font-size:14px; }
  .oauth-btn img { width:20px; height:20px; }
  .oauth-btn.google { background:#fff; color:#000; }
  .oauth-btn.google:hover { background:#f3f4f6; }
  .oauth-btn.apple { background:#000; color:#fff; }
  .oauth-btn.apple:hover { opacity:0.85; }
  .oauth-btn.demo { background:#10b981; color:#fff; }
  .oauth-btn.demo:hover { opacity:0.85; }

  .signup-link { margin-top:16px; font-size:13px; color: var(--muted); }
  .signup-link a { color: var(--accent); text-decoration:none; font-weight:600; }
</style>
</head>

<body>
<div class="container">
  <span class="logo">ðŸ“š eLibrary AI</span>
  <p class="tagline">Login using Google, Apple, or Demo account</p>

  <!-- OAuth Login -->
  <div class="oauth-btn google" id="googleLogin">
    <img src="https://img.icons8.com/color/48/000000/google-logo.png" /> Continue with Google
  </div>
  <div class="oauth-btn apple" id="appleLogin">
    <img src="https://img.icons8.com/ios-filled/50/ffffff/mac-os.png" /> Continue with Apple
  </div>
  <div class="oauth-btn demo" id="demoLogin">
    ðŸ§ª Try Demo Account
  </div>

  <p class="signup-link">Don't have an account? <a href="register.html">Sign up</a></p>
</div>

<script>
const API_BASE = "https://e-library-18tg.onrender.com";

/* ----------------------------------------------------
   GOOGLE LOGIN
------------------------------------------------------ */
document.getElementById('googleLogin').onclick = () => { 
  // Clear previous sessions
  localStorage.clear();
  window.location.href = `${API_BASE}/auths/google?prompt=select_account`;
};

/* ----------------------------------------------------
   APPLE LOGIN
------------------------------------------------------ */
document.getElementById('appleLogin').onclick = () => { 
  localStorage.clear();
  window.location.href = `${API_BASE}/auths/apple`;
};

/* ----------------------------------------------------
   DEMO LOGIN (Anonymous â€“ NOT saved to DB)
------------------------------------------------------ */
document.getElementById('demoLogin').onclick = async () => {
  try {
    const res = await fetch(`${API_BASE}/auths/demo`, { method:'POST' });
    const data = await res.json();

    if(data.status === 'success'){

      // Required by index.html
      localStorage.setItem("elib_demo_account", "true");
      localStorage.setItem("elib_user_name", data.user.name || "Demo User");
      localStorage.setItem("elib_user_photo", data.user.photo || "");

      // Important (index.html checks this)
      localStorage.setItem("elib_user", JSON.stringify(data.user));

      window.location.href = "index.html";
    } 
    else {
      alert(data.message || "Demo login failed");
    }

  } catch(err){
    alert("Demo login failed â€” network/server error");
  }
};
</script>
</body>
</html>